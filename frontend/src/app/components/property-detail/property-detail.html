<div (click)="closeOnOverlay($event)" class="modal-overlay">
  <div class="modal-panel">

    <button (click)="closed.emit()" class="close-btn">✕</button>

    <!-- Galeria de fotos -->
    <div *ngIf="photos.length > 0; else noPhotos" class="gallery">
      <img [src]="selectedPhotoUrl" alt="Foto do imóvel" class="main-photo"/>
      <div *ngIf="photos.length > 1" class="thumbnails">
        <img
          (click)="selectPhoto(i)"
          *ngFor="let photo of photos; let i = index"
          [class.active]="i === selectedPhotoIndex"
          [src]="apiBase + photo.path"
          alt="Miniatura {{ i + 1 }}"
        />
      </div>
    </div>
    <ng-template #noPhotos>
      <div class="no-photo-banner">Sem fotos disponíveis</div>
    </ng-template>

    <!-- Informações -->
    <div class="detail-body">
      <div class="detail-header">
        <h2>{{ property.title }}</h2>
        <span class="price">R$ {{ property.price | number:'1.0-0' }}<span class="per-month">/mês</span></span>
      </div>

      <p *ngIf="property.description" class="description">{{ property.description }}</p>

      <div class="info-grid">
        <div class="info-item">
          <span class="label">Tipo</span>
          <span class="value">{{ typeLabel(property.type) }}</span>
        </div>
        <div class="info-item">
          <span class="label">Vagas disponíveis</span>
          <span class="value">{{ property.availableVacancies ?? '—' }}</span>
        </div>
        <div class="info-item">
          <span class="label">Perfil dos moradores</span>
          <span class="value">{{ genderLabel(property.gender) }}</span>
        </div>
        <div class="info-item">
          <span class="label">Aceita animais</span>
          <span class="value">{{ property.acceptAnimals ? 'Sim' : 'Não' }}</span>
        </div>
      </div>

      <div *ngIf="property.address" class="address-block">
        <h3>Localização</h3>
        <p>
          {{ property.address.street }}, {{ property.address.number }} —
          {{ property.address.district }}, {{ property.address.city }} / {{ property.address.state }}
        </p>
        <p class="cep">CEP: {{ property.address.cep }}</p>
      </div>

      <div *ngIf="property.owner || detail" class="owner-block">
        <h3>Anunciante</h3>
        <p>{{ detail?.nomeProprietario ?? property.owner?.name }}</p>
        <p *ngIf="detail?.emailProprietario" class="owner-email">
          <span class="material-icons" style="font-size:14px;vertical-align:middle">email</span>
          {{ detail!.emailProprietario }}
        </p>
      </div>
    </div>

  </div>
</div>
